<header class="header">
  <img src="assets/images/logo.png" alt="Curriò Logo" class="logo">
  <nav class="main-nav">
    <a routerLink="/auth/login" class="nav-link customer-login-btn">Il mio Curriò!</a>
  </nav>
</header>

<main class="main-content">
  <h1>Curriò: Il tuo Curriculum del futuro, creato come un portfolio.</h1>
  <p class="subheadline">
    Smetti di perdere tempo con layout complicati. Lascia che la nostra tecnologia crei per te un curriculum/portfolio
    automatico, visivamente sorprendente e personalizzato.
  </p>
  <button (click)="openModal()" class="cta-button">Inizia Ora: Crea il Tuo Curriò</button>
</main>

<div id="formModal" class="modal" *ngIf="isModalOpen" (keydown.escape)="closeModal()" tabindex="0">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <span class="close-button" (click)="closeModal()">&times;</span>
    <h2>Inserisci i dati per Curriò</h2>
    <p>Fornisci le informazioni base per permetterci di generare una bozza del tuo Curriò.</p>

    <form id="currioForm" #currioForm="ngForm" (ngSubmit)="onSubmit(currioForm)">
      <div class="form-group">
        <label for="nome">Nome Completo:</label>
        <input type="text" id="nome" name="nome" [(ngModel)]="formData.nome" required #nomeInput="ngModel">
        <div *ngIf="nomeInput.invalid && (nomeInput.dirty || nomeInput.touched)" class="error-message">
          Nome è obbligatorio.
        </div>
      </div>

      <div class="form-group">
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" [(ngModel)]="formData.email" required email #emailInput="ngModel">
        <div *ngIf="emailInput.invalid && (emailInput.dirty || emailInput.touched)" class="error-message">
          <span *ngIf="emailInput.errors?.['required']">Email è obbligatoria.</span>
          <span *ngIf="emailInput.errors?.['email']">Inserisci un indirizzo email valido.</span>
        </div>
      </div>

      <div class="form-group">
        <label for="esperienze">Breve descrizione esperienze (o link profilo LinkedIn):</label>
        <textarea id="esperienze" name="esperienze" rows="4" [(ngModel)]="formData.esperienze" required
          #esperienzeInput="ngModel"></textarea>
        <div *ngIf="esperienzeInput.invalid && (esperienzeInput.dirty || esperienzeInput.touched)"
          class="error-message">
          Descrizione esperienze è obbligatoria.
        </div>
      </div>

      <!-- <div class="form-group">
        <label for="curriculumFile">Allega Curriculum (PDF, JPG, PNG):</label>
        <input type="file" id="curriculumFile" name="curriculumFile" (change)="onFileSelected($event)"
          accept=".pdf,.jpg,.jpeg,.png">
        <div *ngIf="selectedFileName" class="mt-2">
          File selezionato: {{ selectedFileName }}
        </div>
      </div> -->
      <div class="form-group">
        <label for="curriculumFileDropZone">Allega Curriculum (PDF, JPG, PNG - Max 5MB):</label>
        <div id="curriculumFileDropZone" class="drop-zone" (click)="fileInput.click()" (dragover)="onDragOver($event)"
          (dragleave)="onDragLeave($event)" (drop)="onDrop($event)" [class.drag-over]="isDraggingOver">
          <input type="file" #fileInput id="curriculumFile" name="curriculumFile" (change)="onFileSelected($event)"
            accept=".pdf,.jpg,.jpeg,.png" style="display: none" />
          <div class="drop-zone-prompt">
            <p *ngIf="!selectedFileName">Trascina il tuo file qui o clicca per selezionare.</p>
            <p *ngIf="selectedFileName" class="file-selected-text">
              File Selezionato: <strong>{{ selectedFileName }}</strong>
              <br>
              <small>(Clicca o trascina un altro file per sostituire)</small>
            </p>
            <span class="drop-zone-icon feather icon-upload-cloud"></span>
          </div>
        </div>
        <div *ngIf="fileError" class="error-message mt-1">{{ fileError }}</div>
      </div>


      <button type="submit" class="submit-button" [disabled]="!currioForm.valid">Invia Dati</button>
    </form>
  </div>
  <div class="modal-overlay" (click)="closeModal()"></div>
</div>
